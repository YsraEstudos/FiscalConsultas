============================= test session starts =============================
platform win32 -- Python 3.13.5, pytest-9.0.2, pluggy-1.6.0
benchmark: 5.2.3 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: C:\Users\israe\OneDrive\Documentos\faz tudo\Fiscal
configfile: pytest.ini
testpaths: tests
plugins: anyio-4.12.1, asyncio-1.3.0, benchmark-5.2.3, cov-7.0.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 2 items
run-last-failure: rerun previous 2 failures (skipped 43 files)

tests\unit\test_renderer_additional.py F                                 [ 50%]
tests\unit\test_system_routes_endpoints.py F                             [100%]

================================== FAILURES ===================================
_____ test_convert_text_to_html_builds_heading_lists_and_paragraph_blocks _____
tests\unit\test_renderer_additional.py:58: in test_convert_text_to_html_builds_heading_lists_and_paragraph_blocks
    assert '<p class="nesh-paragraph">a) Item A<br>\nb) Item B<br>\ntexto livre</p>' in out
E   assert '<p class="nesh-paragraph">a) Item A<br>\nb) Item B<br>\ntexto livre</p>' in '<h3 class="nesh-heading" data-ncm="8517"><span class="nesh-ncm">85.17</span> - Telefones</h3>\n\n<ol class="nesh-list...lass="nesh-list"><li>Alfa</li><li>Beta</li></ol>\n\n<ol type="a" class="nesh-list"><li>Item A</li><li>Item B</li></ol>'
_______________ test_debug_anchors_filters_position_related_ids _______________
tests\unit\test_system_routes_endpoints.py:232: in test_debug_anchors_filters_position_related_ids
    payload = await system.debug_anchors(request, "8517", service)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
backend\presentation\routes\system.py:190: in debug_anchors
    response_data = await service.process_request(ncm)
                          ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'process_request'
============================== warnings summary ===============================
backend\services\ai_service.py:3
  C:\Users\israe\OneDrive\Documentos\faz tudo\Fiscal\tests\..\backend\services\ai_service.py:3: FutureWarning: 
  
  All support for the `google.generativeai` package has ended. It will no longer be receiving 
  updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
  See README for more details:
  
  https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md
  
    import google.generativeai as genai

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/unit/test_renderer_additional.py::test_convert_text_to_html_builds_heading_lists_and_paragraph_blocks
FAILED tests/unit/test_system_routes_endpoints.py::test_debug_anchors_filters_position_related_ids
======================== 2 failed, 1 warning in 0.47s =========================
